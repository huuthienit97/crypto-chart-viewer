{"ast":null,"code":"var _jsxFileName = \"/Volumes/Extreme SSD/NodeJs/huuthien.vn/huuthien-realtime-crypto/client/src/components/TradingChart.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from 'react';\nimport styled from 'styled-components';\nimport { LineChart, Line, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer } from 'recharts';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Container = styled.div`\n  background: rgba(255, 255, 255, 0.05);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 12px;\n  backdrop-filter: blur(10px);\n  padding: 20px;\n  height: 400px;\n`;\n_c = Container;\nconst Title = styled.h3`\n  margin-bottom: 15px;\n  color: #a0aec0;\n  font-size: 16px;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n`;\n_c2 = Title;\nconst TimeFrameButtons = styled.div`\n  display: flex;\n  gap: 5px;\n`;\n_c3 = TimeFrameButtons;\nconst TimeButton = styled.button`\n  padding: 5px 10px;\n  border: 1px solid rgba(255, 255, 255, 0.2);\n  background: ${props => props.active ? 'rgba(102, 126, 234, 0.3)' : 'transparent'};\n  color: white;\n  border-radius: 4px;\n  font-size: 12px;\n  cursor: pointer;\n  transition: all 0.3s ease;\n  \n  &:hover {\n    background: rgba(102, 126, 234, 0.2);\n  }\n`;\n_c4 = TimeButton;\nconst ChartContainer = styled.div`\n  height: 300px;\n  width: 100%;\n`;\n\n// Mapping timeFrame sang interval Binance\n_c5 = ChartContainer;\nconst timeFrameToInterval = {\n  '1H': '1h',\n  '4H': '4h',\n  '1D': '1d',\n  '1W': '1w'\n};\nconst INTERPOLATE_STEPS = 8;\n\n// H√†m t√°ch d·ªØ li·ªáu th√†nh c√°c ƒëo·∫°n tƒÉng (xanh) v√† gi·∫£m (ƒë·ªè)\nfunction splitChartSegments(data) {\n  if (!data || data.length < 2) return [];\n  const segments = [];\n  let current = [data[0]];\n  let lastType = null;\n  for (let i = 1; i < data.length; i++) {\n    const prev = data[i - 1];\n    const curr = data[i];\n    const type = curr.price >= prev.price ? 'up' : 'down';\n    if (lastType === null) lastType = type;\n    if (type === lastType) {\n      current.push(curr);\n    } else {\n      segments.push({\n        type: lastType,\n        data: [...current]\n      });\n      current = [prev, curr];\n      lastType = type;\n    }\n  }\n  if (current.length > 1) segments.push({\n    type: lastType,\n    data: current\n  });\n  return segments;\n}\nconst TradingChart = ({\n  selectedCrypto,\n  cryptoData\n}) => {\n  _s();\n  var _cryptoData$selectedC3, _cryptoData$selectedC4;\n  const [timeFrame, setTimeFrame] = useState('1H');\n  const [chartData, setChartData] = useState([]);\n  const [isRealtime, setIsRealtime] = useState(true);\n  const [isLoading, setIsLoading] = useState(false);\n  const [targetPrice, setTargetPrice] = useState(null);\n  const [interpolating, setInterpolating] = useState(false);\n  const [interpolateStep, setInterpolateStep] = useState(0);\n  const [lastBinancePrice, setLastBinancePrice] = useState(null);\n  const chartId = useRef(`chart-gradient-${Math.random().toString(36).substr(2, 9)}`);\n\n  // M∆∞·ª£t bi·ªÉu ƒë·ªì khi gi√° Binance thay ƒë·ªïi\n  useEffect(() => {\n    if (!isRealtime) return;\n    let intervalId;\n    let lastPrice = chartData.length > 0 ? chartData[chartData.length - 1].price : null;\n    let steps = 0;\n    let interpolateFrom = lastPrice;\n    let interpolateTo = lastPrice;\n    let interpolateDelta = 0;\n    intervalId = setInterval(() => {\n      var _cryptoData$selectedC, _cryptoData$selectedC2;\n      const binancePrice = (_cryptoData$selectedC = cryptoData[selectedCrypto]) === null || _cryptoData$selectedC === void 0 ? void 0 : _cryptoData$selectedC.price;\n      if (!binancePrice) return;\n      // N·∫øu gi√° Binance thay ƒë·ªïi l·ªõn, b·∫Øt ƒë·∫ßu n·ªôi suy\n      if (lastBinancePrice !== binancePrice) {\n        var _lastPrice;\n        interpolateFrom = (_lastPrice = lastPrice) !== null && _lastPrice !== void 0 ? _lastPrice : binancePrice;\n        interpolateTo = binancePrice;\n        interpolateDelta = (interpolateTo - interpolateFrom) / INTERPOLATE_STEPS;\n        steps = 1;\n        setLastBinancePrice(binancePrice);\n        setInterpolating(true);\n      }\n      let newPrice;\n      if (interpolating && steps <= INTERPOLATE_STEPS) {\n        // N·ªôi suy d·∫ßn\n        newPrice = interpolateFrom + interpolateDelta * steps;\n        steps++;\n        if (steps > INTERPOLATE_STEPS) setInterpolating(false);\n      } else {\n        // N·∫øu kh√¥ng n·ªôi suy, random nh·ªè quanh gi√° cu·ªëi c√πng\n        const base = binancePrice;\n        const variation = (Math.random() - 0.5) * 0.002; // ¬±0.1%\n        newPrice = base * (1 + variation);\n      }\n      const now = new Date();\n      const newDataPoint = {\n        time: now.toLocaleTimeString('vi-VN', {\n          hour: '2-digit',\n          minute: '2-digit',\n          second: '2-digit'\n        }),\n        price: parseFloat(newPrice.toFixed(2)),\n        volume: ((_cryptoData$selectedC2 = cryptoData[selectedCrypto]) === null || _cryptoData$selectedC2 === void 0 ? void 0 : _cryptoData$selectedC2.volume) || 0\n      };\n      setChartData(prevData => {\n        const updatedData = [...prevData, newDataPoint];\n        return updatedData.length > 50 ? updatedData.slice(-50) : updatedData;\n      });\n      lastPrice = newPrice;\n    }, 500);\n    return () => clearInterval(intervalId);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [cryptoData, selectedCrypto, isRealtime]);\n\n  // L·∫•y d·ªØ li·ªáu l·ªãch s·ª≠ th·∫≠t t·ª´ API\n  useEffect(() => {\n    const fetchHistoryData = async () => {\n      setIsLoading(true);\n      try {\n        const interval = timeFrameToInterval[timeFrame] || '1h';\n        const response = await fetch(`/api/history/${selectedCrypto}?interval=${interval}&limit=100`);\n        const data = await response.json();\n        if (data.error) {\n          console.error('L·ªói khi l·∫•y d·ªØ li·ªáu l·ªãch s·ª≠:', data.error);\n          return;\n        }\n        if (data.length > 0) {\n          setChartData(data);\n        }\n      } catch (error) {\n        console.error('L·ªói khi fetch d·ªØ li·ªáu l·ªãch s·ª≠:', error);\n      } finally {\n        setIsLoading(false);\n      }\n    };\n    if (selectedCrypto) {\n      fetchHistoryData();\n    }\n  }, [selectedCrypto, timeFrame]);\n  const CustomTooltip = ({\n    active,\n    payload,\n    label\n  }) => {\n    if (active && payload && payload.length) {\n      const price = payload[0].value;\n      const volume = payload[0].payload.volume;\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          backgroundColor: 'rgba(0, 0, 0, 0.9)',\n          border: '1px solid rgba(255, 255, 255, 0.2)',\n          borderRadius: '8px',\n          padding: '12px',\n          color: 'white',\n          fontSize: '12px',\n          boxShadow: '0 4px 12px rgba(0, 0, 0, 0.3)'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          style: {\n            margin: '0 0 8px 0',\n            fontWeight: 'bold'\n          },\n          children: `‚è∞ ${label}`\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 186,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          style: {\n            color: '#00ff88',\n            margin: '4px 0',\n            fontWeight: 'bold'\n          },\n          children: `üí∞ $${price.toLocaleString('en-US', {\n            minimumFractionDigits: 2,\n            maximumFractionDigits: 2\n          })}`\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 187,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          style: {\n            color: '#a0aec0',\n            margin: '4px 0'\n          },\n          children: `üìä Volume: ${volume.toLocaleString('en-US', {\n            minimumFractionDigits: 2,\n            maximumFractionDigits: 2\n          })}`\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 190,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 177,\n        columnNumber: 9\n      }, this);\n    }\n    return null;\n  };\n  return /*#__PURE__*/_jsxDEV(Container, {\n    children: [/*#__PURE__*/_jsxDEV(Title, {\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'flex',\n          justifyContent: 'space-between',\n          alignItems: 'center',\n          width: '100%'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            children: [\"\\uD83D\\uDCC8 Bi\\u1EC3u \\u0111\\u1ED3 gi\\xE1 - \", selectedCrypto]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 204,\n            columnNumber: 13\n          }, this), cryptoData[selectedCrypto] && /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              fontSize: '12px',\n              color: '#a0aec0',\n              marginTop: '4px'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              style: {\n                color: '#00ff88',\n                fontWeight: 'bold'\n              },\n              children: [\"$\", (_cryptoData$selectedC3 = cryptoData[selectedCrypto].price) === null || _cryptoData$selectedC3 === void 0 ? void 0 : _cryptoData$selectedC3.toLocaleString('en-US', {\n                minimumFractionDigits: 2,\n                maximumFractionDigits: 2\n              })]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 207,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              style: {\n                color: cryptoData[selectedCrypto].change24h >= 0 ? '#00ff88' : '#ff4757',\n                marginLeft: '8px'\n              },\n              children: [cryptoData[selectedCrypto].change24h >= 0 ? '+' : '', (_cryptoData$selectedC4 = cryptoData[selectedCrypto].change24h) === null || _cryptoData$selectedC4 === void 0 ? void 0 : _cryptoData$selectedC4.toFixed(2), \"%\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 210,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 206,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 203,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            display: 'flex',\n            gap: '10px',\n            alignItems: 'center'\n          },\n          children: [/*#__PURE__*/_jsxDEV(TimeFrameButtons, {\n            children: ['1H', '4H', '1D', '1W'].map(tf => /*#__PURE__*/_jsxDEV(TimeButton, {\n              active: timeFrame === tf,\n              onClick: () => setTimeFrame(tf),\n              children: tf\n            }, tf, false, {\n              fileName: _jsxFileName,\n              lineNumber: 222,\n              columnNumber: 17\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 220,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(TimeButton, {\n            active: isRealtime,\n            onClick: () => setIsRealtime(!isRealtime),\n            style: {\n              fontSize: '10px',\n              padding: '4px 8px'\n            },\n            children: isRealtime ? 'üü¢ Live' : 'üî¥ Pause'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 231,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(TimeButton, {\n            onClick: () => {\n              setChartData([]);\n              // Trigger reload\n              const event = new Event('reload');\n              window.dispatchEvent(event);\n            },\n            style: {\n              fontSize: '10px',\n              padding: '4px 8px'\n            },\n            children: \"\\uD83D\\uDD04 Refresh\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 238,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 219,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 202,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 201,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(ChartContainer, {\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          position: 'absolute',\n          top: '10px',\n          right: '10px',\n          fontSize: '12px',\n          color: isRealtime ? '#00ff88' : '#a0aec0',\n          zIndex: 10\n        },\n        children: isRealtime ? 'üü¢ Live' : 'üî¥ Paused'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 254,\n        columnNumber: 9\n      }, this), isLoading ? /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'flex',\n          justifyContent: 'center',\n          alignItems: 'center',\n          height: '100%',\n          color: '#a0aec0',\n          fontSize: '14px'\n        },\n        children: \"\\uD83D\\uDCCA \\u0110ang t\\u1EA3i d\\u1EEF li\\u1EC7u l\\u1ECBch s\\u1EED...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 266,\n        columnNumber: 11\n      }, this) : chartData.length === 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'flex',\n          justifyContent: 'center',\n          alignItems: 'center',\n          height: '100%',\n          color: '#a0aec0',\n          fontSize: '14px'\n        },\n        children: [\"\\uD83D\\uDCCA Kh\\xF4ng c\\xF3 d\\u1EEF li\\u1EC7u cho \", selectedCrypto]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 277,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(ResponsiveContainer, {\n        width: \"100%\",\n        height: \"100%\",\n        children: /*#__PURE__*/_jsxDEV(LineChart, {\n          data: chartData,\n          margin: {\n            top: 20,\n            right: 20,\n            left: 0,\n            bottom: 20\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"defs\", {\n            children: /*#__PURE__*/_jsxDEV(\"linearGradient\", {\n              id: chartId.current,\n              x1: \"0\",\n              y1: \"0\",\n              x2: \"1\",\n              y2: \"0\",\n              children: [/*#__PURE__*/_jsxDEV(\"stop\", {\n                offset: \"0%\",\n                stopColor: \"#00ff88\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 292,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"stop\", {\n                offset: \"100%\",\n                stopColor: \"#ff4757\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 293,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 291,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 290,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(CartesianGrid, {\n            strokeDasharray: \"3 3\",\n            stroke: \"#4442\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 296,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(XAxis, {\n            dataKey: \"time\",\n            minTickGap: 20,\n            tick: {\n              fill: '#a0aec0',\n              fontSize: 12\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 297,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(YAxis, {\n            domain: ['auto', 'auto'],\n            tick: {\n              fill: '#a0aec0',\n              fontSize: 12\n            },\n            width: 60\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 298,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Tooltip, {\n            content: /*#__PURE__*/_jsxDEV(CustomTooltip, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 299,\n              columnNumber: 33\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 299,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Line, {\n            type: \"monotone\",\n            dataKey: \"price\",\n            dot: false,\n            stroke: `url(#${chartId.current})`,\n            strokeWidth: 2.5,\n            isAnimationActive: false,\n            connectNulls: true\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 300,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 289,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 288,\n        columnNumber: 11\n      }, this), chartData.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'flex',\n          justifyContent: 'space-between',\n          marginTop: '10px',\n          fontSize: '11px',\n          color: '#a0aec0'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          children: [\"\\uD83D\\uDCC9 Min: $\", Math.min(...chartData.map(d => d.price)).toLocaleString('en-US', {\n            minimumFractionDigits: 2,\n            maximumFractionDigits: 2\n          })]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 322,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          children: [\"\\uD83D\\uDCC8 Max: $\", Math.max(...chartData.map(d => d.price)).toLocaleString('en-US', {\n            minimumFractionDigits: 2,\n            maximumFractionDigits: 2\n          })]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 325,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          children: [\"\\uD83D\\uDCCA Range: $\", (Math.max(...chartData.map(d => d.price)) - Math.min(...chartData.map(d => d.price))).toLocaleString('en-US', {\n            minimumFractionDigits: 2,\n            maximumFractionDigits: 2\n          })]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 328,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 315,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 253,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 200,\n    columnNumber: 5\n  }, this);\n};\n_s(TradingChart, \"ehdh4rX+KC9p1wHwDlrbPe4Cfg0=\");\n_c6 = TradingChart;\nexport default TradingChart;\nvar _c, _c2, _c3, _c4, _c5, _c6;\n$RefreshReg$(_c, \"Container\");\n$RefreshReg$(_c2, \"Title\");\n$RefreshReg$(_c3, \"TimeFrameButtons\");\n$RefreshReg$(_c4, \"TimeButton\");\n$RefreshReg$(_c5, \"ChartContainer\");\n$RefreshReg$(_c6, \"TradingChart\");","map":{"version":3,"names":["React","useState","useEffect","useRef","styled","LineChart","Line","XAxis","YAxis","CartesianGrid","Tooltip","ResponsiveContainer","jsxDEV","_jsxDEV","Container","div","_c","Title","h3","_c2","TimeFrameButtons","_c3","TimeButton","button","props","active","_c4","ChartContainer","_c5","timeFrameToInterval","INTERPOLATE_STEPS","splitChartSegments","data","length","segments","current","lastType","i","prev","curr","type","price","push","TradingChart","selectedCrypto","cryptoData","_s","_cryptoData$selectedC3","_cryptoData$selectedC4","timeFrame","setTimeFrame","chartData","setChartData","isRealtime","setIsRealtime","isLoading","setIsLoading","targetPrice","setTargetPrice","interpolating","setInterpolating","interpolateStep","setInterpolateStep","lastBinancePrice","setLastBinancePrice","chartId","Math","random","toString","substr","intervalId","lastPrice","steps","interpolateFrom","interpolateTo","interpolateDelta","setInterval","_cryptoData$selectedC","_cryptoData$selectedC2","binancePrice","_lastPrice","newPrice","base","variation","now","Date","newDataPoint","time","toLocaleTimeString","hour","minute","second","parseFloat","toFixed","volume","prevData","updatedData","slice","clearInterval","fetchHistoryData","interval","response","fetch","json","error","console","CustomTooltip","payload","label","value","style","backgroundColor","border","borderRadius","padding","color","fontSize","boxShadow","children","margin","fontWeight","fileName","_jsxFileName","lineNumber","columnNumber","toLocaleString","minimumFractionDigits","maximumFractionDigits","display","justifyContent","alignItems","width","marginTop","change24h","marginLeft","gap","map","tf","onClick","event","Event","window","dispatchEvent","position","top","right","zIndex","height","left","bottom","id","x1","y1","x2","y2","offset","stopColor","strokeDasharray","stroke","dataKey","minTickGap","tick","fill","domain","content","dot","strokeWidth","isAnimationActive","connectNulls","min","d","max","_c6","$RefreshReg$"],"sources":["/Volumes/Extreme SSD/NodeJs/huuthien.vn/huuthien-realtime-crypto/client/src/components/TradingChart.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport styled from 'styled-components';\nimport { LineChart, Line, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer } from 'recharts';\n\nconst Container = styled.div`\n  background: rgba(255, 255, 255, 0.05);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 12px;\n  backdrop-filter: blur(10px);\n  padding: 20px;\n  height: 400px;\n`;\n\nconst Title = styled.h3`\n  margin-bottom: 15px;\n  color: #a0aec0;\n  font-size: 16px;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n`;\n\nconst TimeFrameButtons = styled.div`\n  display: flex;\n  gap: 5px;\n`;\n\nconst TimeButton = styled.button`\n  padding: 5px 10px;\n  border: 1px solid rgba(255, 255, 255, 0.2);\n  background: ${props => props.active ? 'rgba(102, 126, 234, 0.3)' : 'transparent'};\n  color: white;\n  border-radius: 4px;\n  font-size: 12px;\n  cursor: pointer;\n  transition: all 0.3s ease;\n  \n  &:hover {\n    background: rgba(102, 126, 234, 0.2);\n  }\n`;\n\nconst ChartContainer = styled.div`\n  height: 300px;\n  width: 100%;\n`;\n\n// Mapping timeFrame sang interval Binance\nconst timeFrameToInterval = {\n  '1H': '1h',\n  '4H': '4h',\n  '1D': '1d',\n  '1W': '1w'\n};\n\nconst INTERPOLATE_STEPS = 8;\n\n// H√†m t√°ch d·ªØ li·ªáu th√†nh c√°c ƒëo·∫°n tƒÉng (xanh) v√† gi·∫£m (ƒë·ªè)\nfunction splitChartSegments(data) {\n  if (!data || data.length < 2) return [];\n  const segments = [];\n  let current = [data[0]];\n  let lastType = null;\n  for (let i = 1; i < data.length; i++) {\n    const prev = data[i - 1];\n    const curr = data[i];\n    const type = curr.price >= prev.price ? 'up' : 'down';\n    if (lastType === null) lastType = type;\n    if (type === lastType) {\n      current.push(curr);\n    } else {\n      segments.push({ type: lastType, data: [...current] });\n      current = [prev, curr];\n      lastType = type;\n    }\n  }\n  if (current.length > 1) segments.push({ type: lastType, data: current });\n  return segments;\n}\n\nconst TradingChart = ({ selectedCrypto, cryptoData }) => {\n  const [timeFrame, setTimeFrame] = useState('1H');\n  const [chartData, setChartData] = useState([]);\n  const [isRealtime, setIsRealtime] = useState(true);\n  const [isLoading, setIsLoading] = useState(false);\n  const [targetPrice, setTargetPrice] = useState(null);\n  const [interpolating, setInterpolating] = useState(false);\n  const [interpolateStep, setInterpolateStep] = useState(0);\n  const [lastBinancePrice, setLastBinancePrice] = useState(null);\n  const chartId = useRef(`chart-gradient-${Math.random().toString(36).substr(2, 9)}`);\n\n  // M∆∞·ª£t bi·ªÉu ƒë·ªì khi gi√° Binance thay ƒë·ªïi\n  useEffect(() => {\n    if (!isRealtime) return;\n    let intervalId;\n    let lastPrice = chartData.length > 0 ? chartData[chartData.length - 1].price : null;\n    let steps = 0;\n    let interpolateFrom = lastPrice;\n    let interpolateTo = lastPrice;\n    let interpolateDelta = 0;\n\n    intervalId = setInterval(() => {\n      const binancePrice = cryptoData[selectedCrypto]?.price;\n      if (!binancePrice) return;\n      // N·∫øu gi√° Binance thay ƒë·ªïi l·ªõn, b·∫Øt ƒë·∫ßu n·ªôi suy\n      if (lastBinancePrice !== binancePrice) {\n        interpolateFrom = lastPrice ?? binancePrice;\n        interpolateTo = binancePrice;\n        interpolateDelta = (interpolateTo - interpolateFrom) / INTERPOLATE_STEPS;\n        steps = 1;\n        setLastBinancePrice(binancePrice);\n        setInterpolating(true);\n      }\n      let newPrice;\n      if (interpolating && steps <= INTERPOLATE_STEPS) {\n        // N·ªôi suy d·∫ßn\n        newPrice = interpolateFrom + interpolateDelta * steps;\n        steps++;\n        if (steps > INTERPOLATE_STEPS) setInterpolating(false);\n      } else {\n        // N·∫øu kh√¥ng n·ªôi suy, random nh·ªè quanh gi√° cu·ªëi c√πng\n        const base = binancePrice;\n        const variation = (Math.random() - 0.5) * 0.002; // ¬±0.1%\n        newPrice = base * (1 + variation);\n      }\n      const now = new Date();\n      const newDataPoint = {\n        time: now.toLocaleTimeString('vi-VN', { hour: '2-digit', minute: '2-digit', second: '2-digit' }),\n        price: parseFloat(newPrice.toFixed(2)),\n        volume: cryptoData[selectedCrypto]?.volume || 0\n      };\n      setChartData(prevData => {\n        const updatedData = [...prevData, newDataPoint];\n        return updatedData.length > 50 ? updatedData.slice(-50) : updatedData;\n      });\n      lastPrice = newPrice;\n    }, 500);\n    return () => clearInterval(intervalId);\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [cryptoData, selectedCrypto, isRealtime]);\n\n  // L·∫•y d·ªØ li·ªáu l·ªãch s·ª≠ th·∫≠t t·ª´ API\n  useEffect(() => {\n    const fetchHistoryData = async () => {\n      setIsLoading(true);\n      try {\n        const interval = timeFrameToInterval[timeFrame] || '1h';\n        const response = await fetch(`/api/history/${selectedCrypto}?interval=${interval}&limit=100`);\n        const data = await response.json();\n        \n        if (data.error) {\n          console.error('L·ªói khi l·∫•y d·ªØ li·ªáu l·ªãch s·ª≠:', data.error);\n          return;\n        }\n        \n        if (data.length > 0) {\n          setChartData(data);\n        }\n      } catch (error) {\n        console.error('L·ªói khi fetch d·ªØ li·ªáu l·ªãch s·ª≠:', error);\n      } finally {\n        setIsLoading(false);\n      }\n    };\n\n    if (selectedCrypto) {\n      fetchHistoryData();\n    }\n  }, [selectedCrypto, timeFrame]);\n\n  const CustomTooltip = ({ active, payload, label }) => {\n    if (active && payload && payload.length) {\n      const price = payload[0].value;\n      const volume = payload[0].payload.volume;\n      \n      return (\n        <div style={{\n          backgroundColor: 'rgba(0, 0, 0, 0.9)',\n          border: '1px solid rgba(255, 255, 255, 0.2)',\n          borderRadius: '8px',\n          padding: '12px',\n          color: 'white',\n          fontSize: '12px',\n          boxShadow: '0 4px 12px rgba(0, 0, 0, 0.3)'\n        }}>\n          <p style={{ margin: '0 0 8px 0', fontWeight: 'bold' }}>{`‚è∞ ${label}`}</p>\n          <p style={{ color: '#00ff88', margin: '4px 0', fontWeight: 'bold' }}>\n            {`üí∞ $${price.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`}\n          </p>\n          <p style={{ color: '#a0aec0', margin: '4px 0' }}>\n            {`üìä Volume: ${volume.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`}\n          </p>\n        </div>\n      );\n    }\n    return null;\n  };\n\n  return (\n    <Container>\n      <Title>\n        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', width: '100%' }}>\n          <div>\n            <span>üìà Bi·ªÉu ƒë·ªì gi√° - {selectedCrypto}</span>\n            {cryptoData[selectedCrypto] && (\n              <div style={{ fontSize: '12px', color: '#a0aec0', marginTop: '4px' }}>\n                <span style={{ color: '#00ff88', fontWeight: 'bold' }}>\n                  ${cryptoData[selectedCrypto].price?.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}\n                </span>\n                <span style={{ \n                  color: cryptoData[selectedCrypto].change24h >= 0 ? '#00ff88' : '#ff4757',\n                  marginLeft: '8px'\n                }}>\n                  {cryptoData[selectedCrypto].change24h >= 0 ? '+' : ''}{cryptoData[selectedCrypto].change24h?.toFixed(2)}%\n                </span>\n              </div>\n            )}\n          </div>\n          <div style={{ display: 'flex', gap: '10px', alignItems: 'center' }}>\n            <TimeFrameButtons>\n              {['1H', '4H', '1D', '1W'].map(tf => (\n                <TimeButton\n                  key={tf}\n                  active={timeFrame === tf}\n                  onClick={() => setTimeFrame(tf)}\n                >\n                  {tf}\n                </TimeButton>\n              ))}\n            </TimeFrameButtons>\n            <TimeButton\n              active={isRealtime}\n              onClick={() => setIsRealtime(!isRealtime)}\n              style={{ fontSize: '10px', padding: '4px 8px' }}\n            >\n              {isRealtime ? 'üü¢ Live' : 'üî¥ Pause'}\n            </TimeButton>\n            <TimeButton\n              onClick={() => {\n                setChartData([]);\n                // Trigger reload\n                const event = new Event('reload');\n                window.dispatchEvent(event);\n              }}\n              style={{ fontSize: '10px', padding: '4px 8px' }}\n            >\n              üîÑ Refresh\n            </TimeButton>\n          </div>\n        </div>\n      </Title>\n      \n      <ChartContainer>\n        <div style={{ \n          position: 'absolute', \n          top: '10px', \n          right: '10px', \n          fontSize: '12px', \n          color: isRealtime ? '#00ff88' : '#a0aec0',\n          zIndex: 10 \n        }}>\n          {isRealtime ? 'üü¢ Live' : 'üî¥ Paused'}\n        </div>\n        \n        {isLoading ? (\n          <div style={{\n            display: 'flex',\n            justifyContent: 'center',\n            alignItems: 'center',\n            height: '100%',\n            color: '#a0aec0',\n            fontSize: '14px'\n          }}>\n            üìä ƒêang t·∫£i d·ªØ li·ªáu l·ªãch s·ª≠...\n          </div>\n        ) : chartData.length === 0 ? (\n          <div style={{\n            display: 'flex',\n            justifyContent: 'center',\n            alignItems: 'center',\n            height: '100%',\n            color: '#a0aec0',\n            fontSize: '14px'\n          }}>\n            üìä Kh√¥ng c√≥ d·ªØ li·ªáu cho {selectedCrypto}\n          </div>\n        ) : (\n          <ResponsiveContainer width=\"100%\" height=\"100%\">\n            <LineChart data={chartData} margin={{ top: 20, right: 20, left: 0, bottom: 20 }}>\n              <defs>\n                <linearGradient id={chartId.current} x1=\"0\" y1=\"0\" x2=\"1\" y2=\"0\">\n                  <stop offset=\"0%\" stopColor=\"#00ff88\" />\n                  <stop offset=\"100%\" stopColor=\"#ff4757\" />\n                </linearGradient>\n              </defs>\n              <CartesianGrid strokeDasharray=\"3 3\" stroke=\"#4442\" />\n              <XAxis dataKey=\"time\" minTickGap={20} tick={{ fill: '#a0aec0', fontSize: 12 }} />\n              <YAxis domain={['auto', 'auto']} tick={{ fill: '#a0aec0', fontSize: 12 }} width={60} />\n              <Tooltip content={<CustomTooltip />} />\n              <Line\n                type=\"monotone\"\n                dataKey=\"price\"\n                dot={false}\n                stroke={`url(#${chartId.current})`}\n                strokeWidth={2.5}\n                isAnimationActive={false}\n                connectNulls\n              />\n            </LineChart>\n          </ResponsiveContainer>\n        )}\n        \n        {/* Hi·ªÉn th·ªã th√¥ng tin gi√° min/max */}\n        {chartData.length > 0 && (\n          <div style={{\n            display: 'flex',\n            justifyContent: 'space-between',\n            marginTop: '10px',\n            fontSize: '11px',\n            color: '#a0aec0'\n          }}>\n            <span>\n              üìâ Min: ${Math.min(...chartData.map(d => d.price)).toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}\n            </span>\n            <span>\n              üìà Max: ${Math.max(...chartData.map(d => d.price)).toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}\n            </span>\n            <span>\n              üìä Range: ${(Math.max(...chartData.map(d => d.price)) - Math.min(...chartData.map(d => d.price))).toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}\n            </span>\n          </div>\n        )}\n      </ChartContainer>\n    </Container>\n  );\n};\n\nexport default TradingChart; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}